<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>whistle | shadow</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/blog/assets/css/0.styles.0b1ac558.css" as="style"><link rel="preload" href="/blog/assets/js/app.faaa4d6f.js" as="script"><link rel="preload" href="/blog/assets/js/2.50ac7f95.js" as="script"><link rel="preload" href="/blog/assets/js/15.beccba6e.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.d206cb63.js"><link rel="prefetch" href="/blog/assets/js/11.e907298b.js"><link rel="prefetch" href="/blog/assets/js/12.136eb064.js"><link rel="prefetch" href="/blog/assets/js/13.3e9ac2b3.js"><link rel="prefetch" href="/blog/assets/js/14.eb559736.js"><link rel="prefetch" href="/blog/assets/js/16.af5150ff.js"><link rel="prefetch" href="/blog/assets/js/17.dbf952d1.js"><link rel="prefetch" href="/blog/assets/js/18.c318f18c.js"><link rel="prefetch" href="/blog/assets/js/19.42fddf42.js"><link rel="prefetch" href="/blog/assets/js/20.a057d148.js"><link rel="prefetch" href="/blog/assets/js/21.3b99ccf6.js"><link rel="prefetch" href="/blog/assets/js/22.ef7b4cd0.js"><link rel="prefetch" href="/blog/assets/js/23.e3a34ba1.js"><link rel="prefetch" href="/blog/assets/js/3.6eb4007c.js"><link rel="prefetch" href="/blog/assets/js/4.1b609518.js"><link rel="prefetch" href="/blog/assets/js/5.9e2f4ca7.js"><link rel="prefetch" href="/blog/assets/js/6.c7b54f12.js"><link rel="prefetch" href="/blog/assets/js/7.8a5eaf01.js"><link rel="prefetch" href="/blog/assets/js/8.bfde39e2.js"><link rel="prefetch" href="/blog/assets/js/9.7d91f5cb.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.0b1ac558.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">shadow</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/blog/blog/element/element" class="sidebar-heading clickable"><span>element相关</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/blog/element/element.html" class="sidebar-link">穿透更改element</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/blog/babel" class="sidebar-heading clickable"><span>babel相关</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/blog/babel/babel-plugin-remove-module.html" class="sidebar-link">babel-plugin-remove-module</a></li><li><a href="/blog/blog/babel/babel-plugin-auto-report-error.html" class="sidebar-link">babel-plugin-auto-report-error</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/blog/vue" class="sidebar-heading clickable"><span>vue源码相关</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/blog/vue/vue2-lifecycle.html" class="sidebar-link">vue2-lifecycle源码解析</a></li><li><a href="/blog/blog/vue/vue2-computed.html" class="sidebar-link">vue2computed源码解析</a></li><li><a href="/blog/blog/vue/vue2-watch.html" class="sidebar-link">vue2watch源码解析</a></li><li><a href="/blog/blog/vue/vue2-$set.html" class="sidebar-link">vue2$set源码解析</a></li><li><a href="/blog/blog/vue/vue2-mixin.html" class="sidebar-link">vue2mixin合并策略解析</a></li><li><a href="/blog/blog/vue/vue2-vue3-reactive-compare.html" class="sidebar-link">vue2/vue3响应式变更对比</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/blog/daily" class="sidebar-heading clickable router-link-active open"><span>日常记录</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/blog/daily/build-optimization.html" class="sidebar-link">webpack打包优化</a></li><li><a href="/blog/blog/daily/control-request.html" class="sidebar-link">控制重复请求,并返回同段时间内的请求结果</a></li><li><a href="/blog/blog/daily/team-rule.html" class="sidebar-link">团队代码规范</a></li><li><a href="/blog/blog/daily/vue+docker+jenkins.html" class="sidebar-link">vue+docker+jenkins自动化部署</a></li><li><a href="/blog/blog/daily/whistle.html" aria-current="page" class="active sidebar-link">开发工具-whistle</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/blog/daily/whistle.html#whistle-是什么" class="sidebar-link">whistle 是什么?</a></li><li class="sidebar-sub-header"><a href="/blog/blog/daily/whistle.html#安装" class="sidebar-link">安装</a></li><li class="sidebar-sub-header"><a href="/blog/blog/daily/whistle.html#代理" class="sidebar-link">代理</a></li><li class="sidebar-sub-header"><a href="/blog/blog/daily/whistle.html#日常开发的过程中-由于前端开发环境域名-localhost-xxx-和后端的域名不一样导致我们在日常开发的过程中会遇到跨域-cookie-在请求的过程中没有携带等的情况-那么我们用-whistle-如何解决呢" class="sidebar-link">日常开发的过程中,由于前端开发环境域名(localhost:xxx)和后端的域名不一样导致我们在日常开发的过程中会遇到跨域,cookie 在请求的过程中没有携带等的情况.那么我们用 whistle 如何解决呢?</a></li><li class="sidebar-sub-header"><a href="/blog/blog/daily/whistle.html#总结" class="sidebar-link">总结</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/blog/ai" class="sidebar-heading clickable"><span>ai</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/blog/ai/mcpServer.html" class="sidebar-link">开发mcp server</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="whistle"><a href="#whistle" class="header-anchor">#</a> <a href="http://wproxy.org/whistle/" target="_blank" rel="noopener noreferrer">whistle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h1> <h2 id="whistle-是什么"><a href="#whistle-是什么" class="header-anchor">#</a> whistle 是什么?</h2> <p>官方解读:
基于 Node 实现的跨平台 web 调试代理工具，类似的工具有 Windows 平台上的 Fiddler，主要用于查看、修改 HTTP、HTTPS、Websocket 的请求、响应，也可以作为 HTTP 代理服务器使用，不同于 Fiddler 通过断点修改请求响应的方式，whistle 采用的是类似配置系统 hosts 的方式，一切操作都可以通过配置实现，支持域名、路径、正则表达式、通配符、通配路径等多种匹配方式，且可以通过 Node 模块扩展功能：</p> <p>通过以上解读,我们可以抓取到几个关键字: &quot;修改 HTTP/HTTPS/Websocket 的请求&quot;,&quot;作为 HTTP 代理服务器&quot;,&quot;修改请求响应&quot;等功能.那我就在以下介绍几个我日常中会用到的功能.</p> <h2 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h2> <h3 id="whistle-安装"><a href="#whistle-安装" class="header-anchor">#</a> whistle 安装</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># whistle也是一个npm包,所以可以通过npm来安装</span>
<span class="token function">npm</span> <span class="token function">install</span> -g whistle
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 安装完成之后,可以通过以下命令来验证</span>
w2 <span class="token builtin class-name">help</span>

 Usage: whistle <span class="token operator">&lt;</span>command<span class="token operator">&gt;</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span>

  Commands:

  status              Show the running status of whistle
  use/add <span class="token punctuation">[</span>filepath<span class="token punctuation">]</span>  Set rules from a specified js <span class="token function">file</span> <span class="token punctuation">(</span>.whistle.js by default<span class="token punctuation">)</span>
  run                 Start a front <span class="token function">service</span>
  start               Start a background <span class="token function">service</span>
  stop                Stop current background <span class="token function">service</span>
  restart             Restart current background <span class="token function">service</span>
  <span class="token builtin class-name">help</span>                Display <span class="token builtin class-name">help</span> information
  <span class="token punctuation">..</span>.
</code></pre></div><h3 id="switchyomega-安装"><a href="#switchyomega-安装" class="header-anchor">#</a> SwitchyOmega 安装</h3> <p>这个插件主要用于浏览器代理,方便切换一些代理源.
我们可以在 chrome 的扩展程序中找到这个插件,然后进行安装即可.安装成功之后,就可以在插件列表看到了
<img src="https://i.bmp.ovh/imgs/2022/05/14/571686e4fc0b7a65.png" alt="images">
然后进入这个插件列表进行一些配置
<img src="https://i.bmp.ovh/imgs/2022/05/14/394c8c01a79a423a.png" alt="images">
然后
<img src="https://i.bmp.ovh/imgs/2022/05/14/79deeacf2d482423.png" alt="images">
然后
<img src="https://i.bmp.ovh/imgs/2022/05/14/7ff41dc1a598f183.png" alt="images">
到这里我们就完成了 whistle 的配置啦.
然后我们启动我们的 whistle</p> <div class="language-bash extra-class"><pre class="language-bash"><code>w2 start
</code></pre></div><p><img src="https://i.bmp.ovh/imgs/2022/05/14/8472d14e82f838bd.png" alt="images">
然后我们在打开http://127.0.0.1:8899/#network,在这里我们可以看到whistle的页面啦.
<img src="https://i.bmp.ovh/imgs/2022/05/14/18572ae03ec3d9ef.png" alt="images"></p> <hr> <p>现在我们来安装一下 HTTPS 的证书,这样后面我们就可以抓取到 https 的请求.
<img src="https://i.bmp.ovh/imgs/2022/05/14/3dd89b74e7187205.png" alt="images">
安装完成之后,我们随便在 chrome 中输入一个地址,比如https://www.baidu.com/.然后在切换到whistle的network页面,此时我们就可以看到打开百度这个页面的请求啦
<img src="https://s3.bmp.ovh/imgs/2022/05/14/839a2381c77e53ac.jpg" alt="images"></p> <h2 id="代理"><a href="#代理" class="header-anchor">#</a> 代理</h2> <h2 id="日常开发的过程中-由于前端开发环境域名-localhost-xxx-和后端的域名不一样导致我们在日常开发的过程中会遇到跨域-cookie-在请求的过程中没有携带等的情况-那么我们用-whistle-如何解决呢"><a href="#日常开发的过程中-由于前端开发环境域名-localhost-xxx-和后端的域名不一样导致我们在日常开发的过程中会遇到跨域-cookie-在请求的过程中没有携带等的情况-那么我们用-whistle-如何解决呢" class="header-anchor">#</a> 日常开发的过程中,由于前端开发环境域名(localhost:xxx)和后端的域名不一样导致我们在日常开发的过程中会遇到跨域,cookie 在请求的过程中没有携带等的情况.那么我们用 whistle 如何解决呢?</h2> <ol><li>nginx 做中间层代理</li> <li>nginx 做转发</li> <li>webpack.devserver.proxy 做转发</li> <li>whistle</li> <li>...还有很多其他的方法
那么我们这里是介绍 whistle,当然用 whistle 的方法了.
比如我们我们前端的项目启动的域名是(localhost:8080),后端的服务器域名是http://www.test.com/api.此时我们可以在whistle的rules配置里面进行配置</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 这里的意思是,把www.test.com这个域名转发到localhost:8081的页面上</span>
<span class="token comment"># 此时我们在浏览器打开http://www.test.com即可.</span>
<span class="token comment"># excludeFilter的意思是除了www.test.com/api/下面的接口,后面在讲解,这里做个伏笔.</span>
<span class="token comment"># 这样我们在访问www.test.com请求后端服务器的时候,都会把请求发到www.test.com/api/上了,cookie也会相应的带上</span>
http://www.test.com http://localhost:8081 excludeFilter://^www.test.com/api/*
<span class="token comment"># https的也可以哦,是不是很方便</span>
<span class="token comment"># https://www.test.com http://localhost:8081 excludeFilter://^www.test.com/api/*</span>
</code></pre></div><p><img src="https://s3.bmp.ovh/imgs/2022/05/14/2d99eee6111f16f7.jpg" alt="images">
然后通过 http://www.test.com/访问即可.
<img src="https://s3.bmp.ovh/imgs/2022/05/14/a894e3d31053e682.jpg" alt="images">
这样我们就完成了接口代理啦,是不是比在 nginx 那些配置还方便灵活呢.</p> <hr> <p>如果此时我们需要请求服务端的接口,比如是/api/v1/goods 该怎么办呢?</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 这里用axios做简单的演示</span>
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">&quot;axios&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> instance <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 这里的开发环境就用 “/”就好,因为当你不输入域名前缀的时候,请求服务器的接口就会紧跟在当前访问域名的接口后面,下面做演示.其他环境你可以做相应的区分</span>
  <span class="token literal-property property">baseURL</span><span class="token operator">:</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 这里就会请求到 http://www.test.com/api/v1/goods</span>
<span class="token comment">// 还记得我们在whistle做的伏笔吗,那里excludeFilter://^www.test.com/api/</span>
<span class="token comment">// 这里的excludeFilter://^www.test.com/api/指的是www.test.com/api/不会走代理指向http://localhost:8081 .</span>
instance<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/api/v1/goods&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>看了以上代码是不是觉得很方便呢,这里我们不单指解决了跨域的问题,也可能顺便解决了 cookie 传送的问题哦.</p> <hr> <p>上面的域名和本地开发环境的,我们也可以用在不同的环境上.
比如</p> <ul><li>测试环境是 www.test.com</li> <li>预发布环境是 www.uat.com</li> <li>生产环境是 www.prod.com</li></ul> <p>我们通通都可以通过代理来解决以此来达到本地开发环境切换到不同环境的效果哦.加快了我们调试的速度.当然,我们也可以针对某个请求来做一些操作(比如,针对某个请求增加请求头,cookie;针对某个响应数据做一些数据的更改都是可以的).这里就不一一介绍啦,想要知道如何实现可以观看官方文档,我这里介绍的是平常开发环境下会遇到的问题,以及它的解决方案.</p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>最后我们可以知道,whistle是可以&quot;修改 HTTP/HTTPS/Websocket 的请求&quot;,&quot;作为 HTTP 代理服务器&quot;,&quot;修改请求响应&quot;等功能.感兴趣的小伙伴可以自行观看官方文档</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/blog/daily/vue+docker+jenkins.html" class="prev">
        vue+docker+jenkins自动化部署
      </a></span> <span class="next"><a href="/blog/blog/ai/mcpServer.html">
        开发mcp server
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.faaa4d6f.js" defer></script><script src="/blog/assets/js/2.50ac7f95.js" defer></script><script src="/blog/assets/js/15.beccba6e.js" defer></script>
  </body>
</html>
